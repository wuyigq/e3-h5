<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0">

<title>iScroll demo: scrollbars</title>
<link rel="stylesheet" href="../../css/mui.css" />
<link rel="stylesheet" href="../../css/head-foot.css" />
<script type="text/javascript">
var myScroll;
function loaded () {
	myScroll = new IScroll('#wrapper', {
		scrollbars: true,
		mouseWheel: true,
		interactiveScrollbars: true,
		shrinkScrollbars: 'scale',
		fadeScrollbars: true
	});
}
document.addEventListener('touchmove', function (e) { e.preventDefault(); }, false);
</script>

<style type="text/css">
* {
	-webkit-box-sizing: border-box;
	-moz-box-sizing: border-box;
	box-sizing: border-box;
}
html {
	-ms-touch-action: none;
}
body,ul,li {
	padding: 0;
	margin: 0;
	border: 0;
}
body {
	font-size: 12px;
	font-family: ubuntu, helvetica, arial;
	overflow: hidden; /* this is important to prevent the whole page to bounce */
}
#header {
	position: absolute;
	z-index: 2;
	top: 0;
	left: 0;
	width: 100%;
	height: 45px;
	line-height: 45px;
	padding: 0;
}
#wrapper {
	position: absolute;
	z-index: 1;
	top: 86px;
	bottom: 0px;
	left: 0;
	width: 100%;
	background: #ccc;
	overflow: hidden;
}

#segmentedControl{
	position: absolute;
	top: 45px;
	
}


.goods-item-box {
	width: 47%;
	border: 1px solid #ccc;
	margin: 1.5%;
	background: url(../../img/app-botton-right-img.png) no-repeat right bottom;
	background-size: 15% 15%;
}

.goods-img-box {
	width: 100%;
	height: 110px;
	overflow: hidden;
}

.goods-img {
	width: 100%;
	height: 100%;
}

.goods-info-box {
	padding: 5px;
}

.goods-info-box .goods-price {
	color: #159343;
	font-size: 15px;
}

.goods-info-box .mui-icon.mui-icon-location {
	font-size: 15px;
}

.goods-info-box p {
	margin: 0;
}
			
</style>
</head>
<body>
<header class="mui-bar mui-bar-nav header" id="header">
	<a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left"></a>
	<h1 class="mui-title mui-text-left mui-action-back">畜牧产品</h1>
	<!--右边菜单-->
	<a class="mui-icon mui-icon-more mui-pull-right"></a>
	<a class="mui-icon mui-icon-search mui-pull-right" id="search"></a>
</header>
<div id="segmentedControl" class="mui-segmented-control mui-segmented-control-inverted">
	<a class="mui-control-item mui-active" href="#item1" data-sort = '20'>禽类</a>
	<a class="mui-control-item" href="#item2" data-sort = '21'>畜类</a>
	<a class="mui-control-item" href="#item3" data-sort = '22'>水产</a>
	<a class="mui-control-item" href="#item4" data-sort = '23'>其他</a>
</div>
<div id="wrapper">
	<!--<div id="scroller">
		<div id="item1" class="mui-control-content mui-active">-->
		<ul class="goods-list mui-clear" id="list20">
			
			
			<li class="goods-item-box mui-pull-left">
				<div class="goods-img-box">
					<img src="../../img/goods-detail-img.jpg" class="goods-img" />
				</div>
				<div class="goods-info-box">
					<p class="mui-h5">红景天红景天</p>
					<p class="mui-h6">
						<span class="mui-icon mui-icon-location"></span>
						<span class="goods-location">拉萨</span>
					</p>
					<p class="mui-h4 goods-price">2.37-2.46元</p>
				</div>
			</li>
			
			<li class="goods-item-box mui-pull-left">
				<div class="goods-img-box">
					<img src="../../img/goods-detail-img.jpg" class="goods-img" />
				</div>
				<div class="goods-info-box">
					<p class="mui-h5">红景天红景天</p>
					<p class="mui-h6">
						<span class="mui-icon mui-icon-location"></span>
						<span class="goods-location">拉萨</span>
					</p>
					<p class="mui-h4 goods-price">2.37-2.46元</p>
				</div>
			</li>
			
			<li class="goods-item-box mui-pull-left">
				<div class="goods-img-box">
					<img src="../../img/goods-detail-img.jpg" class="goods-img" />
				</div>
				<div class="goods-info-box">
					<p class="mui-h5">红景天红景天</p>
					<p class="mui-h6">
						<span class="mui-icon mui-icon-location"></span>
						<span class="goods-location">拉萨</span>
					</p>
					<p class="mui-h4 goods-price">2.37-2.46元</p>
				</div>
			</li>
			
			<li class="goods-item-box mui-pull-left">
				<div class="goods-img-box">
					<img src="../../img/goods-detail-img.jpg" class="goods-img" />
				</div>
				<div class="goods-info-box">
					<p class="mui-h5">红景天红景天</p>
					<p class="mui-h6">
						<span class="mui-icon mui-icon-location"></span>
						<span class="goods-location">拉萨</span>
					</p>
					<p class="mui-h4 goods-price">2.37-2.46元</p>
				</div>
			</li>
			
			<li class="goods-item-box mui-pull-left">
				<div class="goods-img-box">
					<img src="../../img/goods-detail-img.jpg" class="goods-img" />
				</div>
				<div class="goods-info-box">
					<p class="mui-h5">红景天红景天</p>
					<p class="mui-h6">
						<span class="mui-icon mui-icon-location"></span>
						<span class="goods-location">拉萨</span>
					</p>
					<p class="mui-h4 goods-price">2.37-2.46元</p>
				</div>
			</li>
			
			<li class="goods-item-box mui-pull-left">
				<div class="goods-img-box">
					<img src="../../img/goods-detail-img.jpg" class="goods-img" />
				</div>
				<div class="goods-info-box">
					<p class="mui-h5">红景天红景天</p>
					<p class="mui-h6">
						<span class="mui-icon mui-icon-location"></span>
						<span class="goods-location">拉萨</span>
					</p>
					<p class="mui-h4 goods-price">2.37-2.46元</p>
				</div>
			</li>
		</ul>
	</div> 
	<!--<div id="item2" class="mui-control-content">
		<ul class="goods-list mui-clear" id="list21">
   dasd
		</ul>
	</div>
	<div id="item3" class="mui-control-content">
		<ul class="goods-list mui-clear" id="list22">
        dasa
		</ul>d
	</div>
	<div id="item4" class="mui-control-content">
		<ul class="goods-list mui-clear" id="list23">
			sdas
		</ul>
	</div>-->
	<!--</div>
</div>-->

<<script src="../../js/jquery.min.js"></script>
<script src="../../js/tools.js"></script>
<script src="../../js/mui.js"></script>
<script  src="../../js/iscroll.js"></script>

<script src="../../js/template.js"></script>
<script type="text/html" id="goodslist">
	{{each list}}
	<li class="goods-item-box mui-pull-left clicklist" data-id='{{$value.id}}'>
		<div class="goods-img-box">
			<img src="{{url}}{{$value.cover}}" class="goods-img" />
		</div>
		<div class="goods-info-box">
			<p class="mui-h5">{{$value.name}}</p>
			<p class="mui-h6">
				<span class="mui-icon mui-icon-location"></span>
				<span class="goods-location">{{$value.area}}</span>
			</p>
			<p class="mui-h4 goods-price">{{$value.price_min}}-{{$value.price_max}}元</p>
		</div>
	</li>
	{{/each}}
</script>
<script>
	mui.init();
	mui.plusReady(function() {
	
var myScroll;
loaded() 
function loaded() {
	console.log("start")
	myScroll = new IScroll('#wrapper', {
		scrollbars: true,
		mouseWheel: true,
		interactiveScrollbars: true,
		shrinkScrollbars: 'scale',
		fadeScrollbars: true
	});
}
document.addEventListener('touchmove', function (e) { 
	console.log(00)
	e.preventDefault(); 
}, false);
		console.log(11)
		var param = {
		category_id:'2',
		sort_type:'20',
		page:'1',
		order:'0' 
		};
		mui('.absolute').on('tap', '.clicklist', function() {
			var goodsid = $(this).attr('data-id');
			openWindow('../supply/supply-goods-detail.html', {
				gid: goodsid
			})
		})
		mui(".mui-scroll-wrapper").scroll();  
		//获取农牧产品列表
		getlistdata();
		mui('#segmentedControl').on('tap','.mui-control-item',function(){
			var sort = $(this).attr('data-sort');
			getlistdata(sort)
		})
		function getlistdata(type) {
			console.log('get')
			param.sort_type = type||"20"
			console.log(JSON.stringify(param))
			Ajax({
				url: '/products',
				data: param
			}, function(data) {
				var str = '#list'+param.sort_type 
				if(!data.data.products.length){
					var strs = '暂无数据';
					$(str).html(strs);
					return;
				}
				var obj = {
					url: BASEIMGURL,
					list: data.data.products
				}
				var html = template('goodslist', obj);
				var str = '#list'+param.sort_type 
//				$(str).html(html);
			}, function(err) {
				console.log(JSON.stringify(err))
			})
		}
	})
</script>
</body>

</html>