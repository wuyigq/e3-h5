<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<title></title>
		<script src="../../js/mui.min.js"></script>
		<script src="../../js/ajax.js" charset="UTF-8"></script>
		<link href="../../css/mui.min.css" rel="stylesheet" />
		<link rel="stylesheet" href="../../css/head-foot.css" />
		<style type="text/css">
			.mui-control-content .mui-loading {
				margin-top: 50px;
			}
			/* 测试 */
			
			.mui-slider .mui-slider-group .mui-slider-item {
				height: 600px;
			}
			
			.mui-scroll-wrapper {
				top: 0;
			}
			
			.mui-table-view-cell:after {
				left: 0;
			}
			
			.mui-icon.mui-icon-search {
				font-size: 18px;
				font-weight: bold;
			}
			
			#supply-list .mui-media {}
			
			#supply-list .su-title {
				font-size: 15px;
				color: #666;
			}
			
			#supply-list .su-price {
				font-size: 15px;
				padding-top: 3px;
				color: #2e9d58;
			}
			
			#supply-list .su-mes {
				margin-left: -4px;
			}
			
			#supply-list .su-person {}
			
			#supply-list .su-tel {}
			
			#supply-list .mui-media-object {
				width: 65px;
				max-height: inherit;
				height: 65px;
				max-width: inherit;
			}
			
			.mui-icon.mui-icon-person {
				font-size: 20px;
			}
			
			.mui-icon.mui-icon-phone {
				font-size: 20px;
			}
			
			#buy-wapper .mui-icon.mui-icon-person {
				font-size: 18px;
			}
			
			#buy-wapper .mui-icon.mui-icon-phone {
				font-size: 17px;
			}
			
			#buy-wapper .buy-mes {
				width: 57%;
			}
			
			#buy-wapper .time-box {
				width: 43%;
			}
			/*#item3 {height: 300px;}*/
			
			#item3 .mui-scroll-wrapper {
				top: 46px;
			}
			
			#item3 .mui-grid-view {
				background-color: #fff;
			}
			
			#item3 .mui-grid-view .mui-table-view-cell {
				background-color: #fff;
			}
			
			.mui-icon.mui-icon-arrowdown {
				color: #aaa;
				font-size: 15px;
				margin-left: -4px;
			}
			
			#show-data .info-item {
				width: 25%;
				text-align: center;
				color: #666;
			}
			
			#show-data .mui-table-view-cell {
				padding: 10px 0;
			}
			
			#show-data .mui-table-view-cell:nth-child(2n+1) {
				background-color: #F7F7F7;
			}
			/*.mui-h6{
				color: #2E9D58
			}*/
			.goodspic{
				height: 65px;
				width: 65px;
				margin-right: 1rem;
			}
		</style>
	</head>

	<body>
		<div class="mui-content">
			<div>
				<div id="segmentedControl" class="mui-segmented-control mui-segmented-control-inverted">
					<a class="mui-control-item mui-active" href="#item1">供应</a>
					<a class="mui-control-item" href="#item2">求购</a>
				</div>
			</div>
			<div>
				<div id="item1" class="mui-control-content mui-active">
					<div id="scroll" class="mui-scroll-wrapper">
						<div class="mui-scroll">
							<ul class="mui-table-view" id="supply-list">
								<script type="text/html" id="supply-list-template">
									{{each list}}
									<li class="mui-table-view-cell supply-item" data-id="{{$value.id}}" data-productid="{{$value.product_id}}">
										<img src="{{baseImg + $value.cover}}" class="mui-pull-left goodspic" />
										<div class="mui-media-body">
											<p class="su-title mui-ellipsis">[{{$value.product_sort_type}}] {{$value.product_name}}</p>
											<p class="su-price mui-ellipsis" style="margin-top: 4px;">{{$value.price_min}}-{{$value.price_max}}元</p>
											<div class="mui-h5 su-mes mui-ellipsis" style="margin-left: -2px; margin-top: 3px;">
												<span class="mui-icon mui-icon-person" style="color: #0099ff;"></span>
												<span class="su-person">{{$value.contact_name}}</span>
												<span class="mui-icon mui-icon-phone" style="color: #0099ff;"></span>
												<span class="su-tel">{{$value.contact_mobile}}</span>
											</div>
										</div>
									</li>
									{{/each}}
								</script>
							</ul>
						</div>
					</div>
				</div>
				<div id="item2" class="mui-control-content">
					<div class="mui-scroll-wrapper">
						<div class="mui-scroll">
							<ul class="mui-table-view" id="buy-wapper">
								<script type="text/html" id="buy-wapper-template">
									{{each list}}
									<li class="mui-table-view-cell supply-item" data-id="{{$value.id}}" data-productid="{{$value.product_id}}">
										<img src="{{baseImg + $value.cover}}" class="mui-pull-left goodspic" />
										<div class="mui-media-body">
											<p class="su-title mui-ellipsis">[{{$value.product_sort_type}}] {{$value.product_name}}</p>
											<p class="su-price mui-ellipsis" style="margin-top: 4px;">{{$value.price_min}}-{{$value.price_max}}元</p>
											<div class="mui-h5 su-mes mui-ellipsis" style="margin-left: -2px; margin-top: 3px;">
												<span class="mui-icon mui-icon-person" style="color: #0099ff;"></span>
												<span class="su-person">{{$value.contact_name}}</span>
												<span class="mui-icon mui-icon-phone" style="color: #0099ff;"></span>
												<span class="su-tel">{{$value.contact_mobile}}</span>
											</div>
										</div>
									</li>
									{{/each}}
								</script>
							</ul>
						</div>
					</div>
				</div>
			</div>
		</div>
		<style type="text/css">
			.mui-popover .mui-scroll-wrapper {
				margin: 0;
				border-radius: 0;
			}
			
			.mui-popover {
				top: 50%;
				width: 200px;
				height: 150px;
				margin-top: -75px;
				font-size: 12px;
				/*box-shadow: none;*/
				border-radius: 10px;
				left: 50%;
				margin-left: -100px;
				overflow: hidden;
			}
			/*#area-pupover {
				left: 0;
				height: 200px;
			}
			
			#market-pupover {
				left: 25%;
				height: 100px;
			}
			
			#classify-pupover {
				left: 50%;
				height: 250px;
			}*/
			
			.mui-popover .mui-table-view-divider {
				padding: 10px 0;
				text-align: center;
			}
			
			.mui-popover .mui-table-view-cell {
				padding: 5px 0;
				text-align: center;
				color: #666;
			}
		</style>
		<div id="area-pupover" class="mui-popover">
			<div class="mui-scroll-wrapper">
				<div class="mui-scroll">
					<ul class="mui-table-view">
						<li class="mui-table-view-cell" data-id="拉萨">拉萨</li>
						<li class="mui-table-view-cell" data-id="日喀则">日喀则</li>
						<li class="mui-table-view-cell" data-id="山南">山南</li>
						<li class="mui-table-view-cell" data-id="林芝">林芝</li>
						<li class="mui-table-view-cell" data-id="昌都">昌都</li>
						<li class="mui-table-view-cell" data-id="那曲">那曲</li>
						<li class="mui-table-view-cell" data-id="阿里">阿里</li>
					</ul>
				</div>
			</div>
		</div>
		<div id="classify-pupover" class="mui-popover">
			<div class="mui-scroll-wrapper">
				<div class="mui-scroll">
					<ul class="mui-table-view">
						<li class="mui-table-view-cell" data-id="粮油">粮油</li>
						<li class="mui-table-view-cell" data-id="果蔬">果蔬</li>
						<li class="mui-table-view-cell" data-id="花卉">花卉</li>
						<li class="mui-table-view-cell" data-id="食用菌">食用菌</li>
						<li class="mui-table-view-cell" data-id="干果">干果</li>
						<li class="mui-table-view-cell" data-id="副食">副食</li>
						<li class="mui-table-view-cell" data-id="禽类">禽类</li>
						<li class="mui-table-view-cell" data-id="畜类">畜类</li>
						<li class="mui-table-view-cell" data-id="水产">水产</li>
						<li class="mui-table-view-cell" data-id="植物类">植物类</li>
						<li class="mui-table-view-cell" data-id="动物类">动物类</li>
						<li class="mui-table-view-cell" data-id="工艺饰品">工艺饰品</li>
						<li class="mui-table-view-cell" data-id="日常用品">日常用品</li>
						<li class="mui-table-view-cell" data-id="雪域山珍">雪域山珍</li>
						<li class="mui-table-view-cell" data-id="其他">其他</li>
					</ul>
				</div>
			</div>
		</div>

		<script src="../../js/jquery.min.js"></script>
		<script src="../../js/template.js"></script>
		<script src="../../js/tools.js"></script>
		<script>
			var marketeara = 1;
			var goodstype = 1;
			mui.init();
			var alllist;
			var allkinds
			mui.plusReady(function() {
				mui(".mui-scroll-wrapper").scroll();
				mui(".mui-popover .mui-scroll-wrapper").scroll();
				$("#item1,#item2, #item3").height($(document).height() - 91 + "px");
				// 供应
				$("#supply-list").on("tap", ".mui-table-view-cell", function() {
					var id = $(this).attr("data-productid");
					var person = $(this).find(".su-person").html();
					var tel = $(this).find(".su-tel").html();
					openWindow("./supply-goods-detail.html", {
						gid: id,
						person: person,
						tel: tel
					})
				})
				$("#buy-wapper").on("tap", ".mui-table-view-cell", function() {
						var id = $(this).attr("data-productid");
						var person = $(this).find(".buy-person").html();
						var tel = $(this).find(".buy-tel").html();
						openWindow("./supply-goods-detail.html", {
							gid: id,
							person: person,
							tel: tel
						})
					})
					// 显示分类popover
				$("#area-choose").on("tap", function() {
					mui("#area-pupover").popover("show")
				})
				$("#market-choose").on("tap", function() {
					mui("#market-pupover").popover("show")
				})
				$("#classify-choose").on("tap", function() {
					mui("#classify-pupover").popover("show")
				})
				mui('#area-pupover').on('tap', '.mui-table-view-cell', function() {
					mui("#area-pupover").popover("hide");
					$("#show-data").html('')
					var temp = [];
					marketeara = $(this).attr('data-id');
					var len = alllist.length;
					for (var i = 0; i < len; i++) {
						if (alllist[i].area == marketeara) {
							temp.push(alllist[i]);
						}
					}
					var obj = {
						list: temp
					}
					var html = template("show-data-template", obj)
					$("#show-data").html(html)
				})
				mui('#classify-pupover').on('tap', '.mui-table-view-cell', function() {
					mui("#classify-pupover").popover("hide");
					$("#show-data").html('')
					goodstype = $(this).attr('data-id');
					var temp = [];
					var len = alllist.length;
					for (var i = 0; i < len; i++) {
						if (alllist[i].sort_name == goodstype) {
							temp.push(alllist[i]);
						}
					}
					var obj = {
						list: temp
					}
					var html = template("show-data-template", obj)
					$("#show-data").html(html)
				})
				sellBuyOne()

				function sellBuyOne() {
					ajax_get_supply_list({
						data: {
							type: 1
						}
					}, function(data) {
						console.log(JSON.stringify(data))
						var obj = {
							list: data.sell_buys,
							baseImg: ""//BASEIMGURL
						}
						var html = template("supply-list-template", obj)
						$("#supply-list").html(html)
					}, function(err) {
						console.log(JSON.stringify(err))
					})
				}
				sellBuyTwo()

				function sellBuyTwo() {
					ajax_get_demand_list({
						data: {
							type: 2
						}
					}, function(data) {
						console.log('sell' + JSON.stringify(data))
						var obj = {
							list: data.sell_buys,
							baseImg: ""//BASEIMGURL
						}
						var html = template("buy-wapper-template", obj)
						$("#buy-wapper").html(html)
					}, function(err) {
						console.log(JSON.stringify(err))
					})
				}
			})
		</script>
	</body>

</html>